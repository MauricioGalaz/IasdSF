<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IASD - Oraci√≥n</title>
    <meta name="description"
        content="Comunidad de fe de la Iglesia Adventista del S√©ptimo D√≠a de San Francisco de Limache. Comparte tus oraciones, testimonios y estudia la Palabra de Dios con nosotros.">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Open+Sans:wght@300;400;600;700&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        // 1. Configuraci√≥n y Base de Datos
        const CLAVE_ADMIN = "iasdsf";

        const iasdDB = {
            save: (key, data) => {
                let list = JSON.parse(localStorage.getItem(key)) || [];
                list.unshift(data);
                localStorage.setItem(key, JSON.stringify(list));
                if (typeof actualizarListas === 'function') actualizarListas();
                Swal.fire({ title: '¬°Registrado!', icon: 'success', confirmButtonColor: '#002D56' });
            },
            get: (key) => JSON.parse(localStorage.getItem(key)) || []
        };

        // 2. Validaci√≥n de Seguridad
        async function validarAccion(callback) {
            const { value: password } = await Swal.fire({
                title: 'Seguridad',
                input: 'password',
                inputLabel: 'Introduce la contrase√±a para eliminar',
                confirmButtonColor: '#002D56',
                showCancelButton: true
            });

            if (password === CLAVE_ADMIN) {
                callback();
            } else if (password !== undefined) {
                Swal.fire({ icon: 'error', title: 'Error', text: 'Contrase√±a incorrecta.' });
            }
        }

        // 3. Generador de PDF Corregido (Evita celdas vac√≠as)
        function generarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFillColor(0, 45, 86);
            doc.rect(0, 0, 210, 30, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(16);
            doc.text("REPORTE IASD SAN FRANCISCO DE LIMACHE", 15, 20);

            let y = 45;
            const secciones = [
                { k: 'pedidos', t: 'PETICIONES' },
                { k: 'agradecimientos', t: 'AGRADECIMIENTOS' },
                { k: 'testimonios', t: 'TESTIMONIOS' }
            ];

            secciones.forEach(sec => {
                const datos = iasdDB.get(sec.k);
                if (datos.length > 0) {
                    doc.setTextColor(0, 45, 86);
                    doc.setFontSize(14);
                    doc.text(sec.t, 15, y);

                    doc.autoTable({
                        startY: y + 5,
                        head: [['Fecha', 'Nombre', 'Detalle']],
                        body: datos.map(item => [
                            item.date || "-",
                            item.name || "An√≥nimo",
                            item.content || "Sin detalle"
                        ]),
                        headStyles: { fillColor: [0, 188, 140] },
                        theme: 'grid'
                    });
                    y = doc.lastAutoTable.finalY + 15;
                }
            });
            doc.save("Reporte_IASD.pdf");
        }

        // 4. Capturador Universal de Formularios
        document.addEventListener('submit', function (e) {
            e.preventDefault();
            const form = e.target;

            // Extraer datos buscando por IDs comunes o tipos de campo
            const nombre = form.querySelector('input[type="text"]')?.value || "An√≥nimo";
            const categoria = form.querySelector('select')?.value || "General";
            const contenido = form.querySelector('textarea')?.value || "";

            if (!contenido) return Swal.fire('Error', 'El detalle es obligatorio', 'error');

            const data = {
                date: new Date().toLocaleString('es-CL'),
                name: nombre,
                category: categoria,
                content: contenido
            };

            let key = "";
            if (form.id.includes('prayer')) key = 'pedidos';
            else if (form.id.includes('thanks')) key = 'agradecimientos';
            else if (form.id.includes('testimony')) key = 'testimonios';

            if (key) {
                iasdDB.save(key, data);
                form.reset();
            }
        });
    </script>
</head>
<style>
    /* --- VARIABLES DE COLOR --- */
    :root {
        --primary-blue: #002D56;
        --accent-gold: #B8860B;
        --text-main: #1A1A1A;
        --text-muted: #444444;
        --bg-light: #F4F7F9;
        --white: #FFFFFF;
    }

    /* --- RESET Y BASES --- */
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }

    html,
    body {
        overflow-x: hidden;
        /* Evita el desbordamiento lateral */
        width: 100%;
    }

    body {
        font-family: 'Open Sans', sans-serif;
        line-height: 1.6;
        color: var(--text-main);
        background-color: var(--bg-light);
    }

    .container {
        width: 100%;
        max-width: 1100px;
        margin: 0 auto;
        padding: 0 20px;
    }

    /* --- NAVEGACI√ìN --- */
    .navbar {
        background: var(--primary-blue);
        padding: 12px 0;
        position: sticky;
        top: 0;
        z-index: 1000;
        width: 100%;
    }

    .nav-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .logo {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .logo-img {
        height: 40px;
        width: 40px;
        object-fit: cover;
        border-radius: 50%;
    }

    .nav-menu {
        display: flex;
        list-style: none;
        gap: 20px;
    }

    .nav-link {
        color: var(--white);
        text-decoration: none;
        font-weight: 700;
        font-size: 14px;
    }

    /* --- HERO SECTION --- */
    .hero-section {
        position: relative;
        min-height: 60vh;
        display: flex;
        align-items: center;
        padding: 60px 0;
        background: linear-gradient(rgba(0, 45, 86, 0.7), rgba(0, 45, 86, 0.7)),
            url('imagenes/oracion.jpg') no-repeat center center/cover;
        text-align: center;
        color: white;
    }

    .hero-content {
        position: relative;
        z-index: 2;
        width: 100%;
    }

    .roboto-title {
        font-size: clamp(1.8rem, 5vw, 2.5rem);
        font-weight: 800;
        margin-bottom: 10px;
        text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.5);
    }

    .verse-box {
        max-width: 600px;
        margin: 20px auto;
        padding: 20px;
        background: rgba(255, 255, 255, 0.1);
        border-left: 5px solid var(--accent-gold);
        backdrop-filter: blur(5px);
        border-radius: 0 10px 10px 0;
    }

    .verse-text {
        font-size: 1.1rem;
        font-style: italic;
    }

    /* --- GRID DE CONTENIDO --- */
    .content-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
        margin-top: 30px;
    }

    .form-card,
    .prayers-list-card,
    .study-card {
        background: var(--white);
        padding: 25px;
        border-radius: 12px;
        border: 2px solid #D1D8DD;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* --- ELEMENTOS DE FORMULARIO --- */
    input,
    select,
    textarea {
        width: 100%;
        padding: 12px;
        margin-top: 8px;
        margin-bottom: 15px;
        border: 2px solid #ccc;
        border-radius: 8px;
        font-size: 16px;
        /* Evita zoom molesto en iPhone */
    }

    .btn {
        width: 100%;
        padding: 15px;
        border-radius: 8px;
        font-weight: 800;
        border: none;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        transition: 0.3s;
        text-decoration: none;
    }

    .btn-primary {
        background: var(--primary-blue);
        color: white;
    }

    .btn-secondary {
        background: var(--accent-gold);
        color: white;
    }

    /* --- FOOTER --- */
    .main-footer {
        background: var(--primary-blue);
        color: white;
        padding: 40px 0 20px;
        margin-top: 50px;
    }

    .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 30px;
    }

    /* --- RESPONSIVIDAD (M√≥viles) --- */
    @media (max-width: 768px) {
        .nav-menu {
            display: none;
            /* Oculto hasta que actives el JS del bot√≥n */
            flex-direction: column;
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: var(--primary-blue);
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-menu.active {
            display: flex;
        }

        .hero-buttons {
            flex-direction: column;
        }

        .content-grid {
            grid-template-columns: 1fr;
            /* Una sola columna en m√≥vil */
        }

        .roboto-title {
            font-size: 1.6rem;
        }

        .verse-box {
            width: 95%;
            margin: 20px auto;
        }
    }
</style>


<body>
    <!-- Header & Navigation -->
    <header class="main-header">
        <nav class="navbar">
            <div class="container nav-container">

                <!-- LOGO -->
                <div class="logo">
                    <img src="imagenes/oracion.jpg" alt="Logo IASD" class="logo-img">

                    <div class="logo-text">
                        <h1>IASD San Francisco de Limache</h1>
                    </div>
                </div>

                <!-- BOT√ìN HAMBURGUESA -->
                <button class="mobile-menu-toggle" id="menuToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>

                <!-- MEN√ö -->
                <ul class="nav-menu" id="navMenu">
                    <li><a href="#inicio" class="nav-link"><i class="fas fa-home"></i> Inicio</a></li>
                    <li><a href="#oracion" class="nav-link"><i class="fas fa-praying-hands"></i> Oraci√≥n</a></li>
                    <li><a href="#estudio" class="nav-link"><i class="fas fa-bible"></i> Estudio</a></li>
                    <li>
                        <a href="../index.html" class="nav-link">
                            <i class="fas fa-arrow-left"></i> Volver a la App
                        </a>
                    </li>


                </ul>

            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section id="inicio" class="hero-section">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <div class="container">
                <h2 class="roboto-title">Bienvenidos a Nuestra Familia de Fe</h2>
                <p class="hero-subtitle">Ministerio de Oraci√≥n Intercesora</p>
                <div class="verse-box">
                    <i class="fas fa-bible"></i>
                    <p class="verse-text">"Porque donde est√°n dos o tres congregados en mi nombre, all√≠ estoy yo en
                        medio de ellos."</p>
                    <p class="verse-ref">Mateo 18:20</p>
                </div>
                <div class="hero-buttons">
                    <a href="#oracion" class="btn btn-primary"><i class="fas fa-praying-hands"></i> Compartir Pedido de
                        Oraci√≥n</a>
                    <a href="#testimonios" class="btn btn-secondary"><i class="fas fa-comment-dots"></i> Compartir
                        Testimonio</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Pedidos de Oraci√≥n Section -->
    <section id="oracion" class="section prayer-section">
        <div class="container">
            <div class="section-header">
                <i class="fas fa-praying-hands section-icon"></i>
                <h2 class="section-title">Pedidos de Oraci√≥n</h2>
                <p class="section-description">Comparte tus necesidades con nuestra familia de fe. Oramos unos por
                    otros.</p>
            </div>

            <div class="content-grid">
                <!-- Formulario de Pedido -->
                <div class="form-card">
                    <h3><i class="fas fa-plus-circle"></i> Nuevo Pedido de Oraci√≥n</h3>
                    <form id="prayer-form" class="prayer-form">
                        <div class="form-group">
                            <label for="prayer-name"><i class="fas fa-user"></i> Tu Nombre</label>
                            <input type="text" id="prayer-name" name="nombre" required placeholder="Ingresa tu nombre">
                        </div>

                        <div class="form-group">
                            <label for="prayer-category"><i class="fas fa-list"></i> Categor√≠a</label>
                            <select id="prayer-category" name="categoria" required>
                                <option value="">Selecciona una categor√≠a</option>
                                <option value="salud">Salud</option>
                                <option value="familia">Familia</option>
                                <option value="trabajo">Trabajo/Estudios</option>
                                <option value="espiritual">Vida Espiritual</option>
                                <option value="otro">Otro</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="prayer-request"><i class="fas fa-pen"></i> Tu Petici√≥n</label>
                            <textarea id="prayer-request" name="peticion" required rows="5"
                                placeholder="Comparte tu necesidad de oraci√≥n..."></textarea>
                        </div>

                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Enviar Pedido
                        </button>
                    </form>
                </div>

                <!-- Lista de Pedidos -->
                <div class="prayers-list-card">
                    <h3><i class="fas fa-list"></i> Peticiones Activas</h3>
                    <div class="filters">
                        <button class="filter-btn" data-filter="todos">Todos</button>
                        <button class="filter-btn" data-filter="salud">Salud</button>
                        <button class="filter-btn" data-filter="familia">Familia</button>
                        <button class="filter-btn" data-filter="trabajo">Trabajo</button>
                        <button class="filter-btn" data-filter="espiritual">Espiritual</button>

                    </div>

                    <div id="prayers-list" class="prayers-list">
                        <div class="loading">
                            <i class="fas fa-spinner fa-spin"></i> Cargando peticiones...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Agradecimientos Section -->
    <section id="agradecimientos" class="section thanksgiving-section">
        <div class="container">
            <div class="section-header">
                <i class="fas fa-heart section-icon"></i>
                <h2 class="section-title">Agradecimientos a Dios</h2>
                <p class="section-description">Celebramos las bendiciones y respuestas a nuestras oraciones.</p>
            </div>

            <div class="content-grid">

                <!-- Formulario de Agradecimiento -->
                <div class="form-card">
                    <h3><i class="fas fa-plus-circle"></i> Compartir Agradecimiento</h3>
                    <form id="thanksgiving-form" class="thanksgiving-form">
                        <div class="form-group">
                            <label for="thanks-name"><i class="fas fa-user"></i> Tu Nombre</label>
                            <input type="text" id="thanks-name" name="nombre" required placeholder="Ingresa tu nombre">
                        </div>

                        <div class="form-group">
                            <label for="thanks-category"><i class="fas fa-list"></i> Categor√≠a de Bendici√≥n</label>
                            <select id="thanks-category" name="categoria" required>
                                <option value="">Selecciona una categor√≠a</option>
                                <option value="salud">Sanidad</option>
                                <option value="provision">Provisi√≥n</option>
                                <option value="familia">Familia</option>
                                <option value="trabajo">Trabajo</option>
                                <option value="espiritual">Crecimiento Espiritual</option>
                                <option value="otro">Otro</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="thanks-testimony"><i class="fas fa-pen"></i> Tu Testimonio de Gratitud</label>
                            <textarea id="thanks-testimony" name="testimonio" required rows="5"
                                placeholder="Comparte c√≥mo Dios ha bendecido tu vida..."></textarea>
                        </div>

                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Compartir Agradecimiento
                        </button>
                    </form>
                </div>

                <!-- Lista de Agradecimientos -->
                <div class="thanksgiving-list-card">
                    <h3><i class="fas fa-list"></i> Testimonios de Gratitud</h3>
                    <div id="thanksgiving-list" class="thanksgiving-list">
                        <div class="loading">
                            <i class="fas fa-spinner fa-spin"></i> Cargando agradecimientos...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonios Section -->
    <section id="testimonios" class="section testimonies-section">
        <div class="container">
            <div class="section-header">
                <i class="fas fa-comment-dots section-icon"></i>
                <h2 class="section-title">Testimonios de Fe</h2>
                <p class="section-description">Historias de c√≥mo Dios transforma vidas y fortalece nuestra fe.</p>
            </div>

            <div class="content-grid">
                <!-- Formulario de Testimonio -->
                <div class="form-card">
                    <h3><i class="fas fa-plus-circle"></i> Compartir Testimonio</h3>
                    <form id="testimony-form" class="testimony-form">
                        <div class="form-group">
                            <label for="testimony-name"><i class="fas fa-user"></i> Tu Nombre</label>
                            <input type="text" id="testimony-name" name="nombre" required
                                placeholder="Ingresa tu nombre">
                        </div>

                        <div class="form-group">
                            <label for="testimony-title"><i class="fas fa-heading"></i> T√≠tulo del Testimonio</label>
                            <input type="text" id="testimony-title" name="titulo" required
                                placeholder="Ej: C√≥mo Dios restaur√≥ mi familia">
                        </div>

                        <div class="form-group">
                            <label for="testimony-content"><i class="fas fa-pen"></i> Tu Testimonio</label>
                            <textarea id="testimony-content" name="contenido" required rows="6"
                                placeholder="Comparte tu experiencia de fe..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="testimony-verse"><i class="fas fa-bible"></i> Vers√≠culo Relacionado
                                (opcional)</label>
                            <input type="text" id="testimony-verse" name="versiculo" placeholder="Ej: Juan 3:16">
                        </div>

                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Compartir Testimonio
                        </button>
                    </form>
                </div>

                <!-- Lista de Testimonios -->
                <div class="testimonies-list-card">
                    <h3><i class="fas fa-list"></i> Testimonios de la Comunidad</h3>
                    <div id="testimonies-list" class="testimonies-list">
                        <div class="loading">
                            <i class="fas fa-spinner fa-spin"></i> Cargando testimonios...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Estudio B√≠blico Section -->
    <section id="estudio" class="section study-section">
        <div class="container">
            <div class="section-header">
                <i class="fas fa-book-open section-icon"></i>
                <h2 class="section-title">Estudio B√≠blico</h2>
                <p class="section-description">Recursos y gu√≠as para profundizar en la Palabra de Dios.</p>
            </div>

            <div class="study-grid">
                <!-- Gu√≠as de Estudio -->
                <div class="study-card">
                    <div class="study-card-icon">
                        <i class="fas fa-book-reader"></i>
                    </div>
                    <h3>Gu√≠as de Estudio Diario</h3>
                    <p>Recursos para tu estudio personal de la Biblia</p>
                    <ul class="study-list">
                        <li><a href="https://am.adventistas.org/es/recursos/videos/" target="_blank"><i
                                    class="fas fa-video"></i> Lecciones en Video</a></li>
                        <li><a href="https://escuelasabatica.cl/" target="_blank"><i class="fas fa-book"></i> Lecci√≥n de
                                Escuela Sab√°tica</a></li>
                        <li><a href="https://www.adventistas.org/es/institucional/recursos-biblicos/" target="_blank"><i
                                    class="fas fa-clipboard-list"></i> Gu√≠as Tem√°ticas</a></li>
                        <li><a href="https://www.biblegateway.com/versions/Reina-Valera-1960-RVR1960-Biblia/"
                                target="_blank"><i class="fas fa-bible"></i> Biblia en L√≠nea</a></li>
                    </ul>
                </div>

                <!-- Estudios Tem√°ticos -->
                <div class="study-card">
                    <div class="study-card-icon">
                        <i class="fas fa-scroll"></i>
                    </div>
                    <h3>Estudios Tem√°ticos</h3>
                    <p>Profundiza en temas espec√≠ficos de la fe</p>
                    <ul class="study-list">
                        <li><i class="fas fa-cross"></i> El Plan de Salvaci√≥n</li>
                        <li><i class="fas fa-dove"></i> El Esp√≠ritu Santo</li>
                        <li><i class="fas fa-hands-praying"></i> La Oraci√≥n Eficaz</li>
                        <li><i class="fas fa-heart"></i> El Amor de Dios</li>
                        <li><i class="fas fa-crown"></i> La Segunda Venida</li>
                        <li><i class="fas fa-hand-holding-heart"></i> Vida Cristiana Pr√°ctica</li>
                    </ul>
                </div>

                <!-- Recursos Adventistas -->
                <div class="study-card">
                    <div class="study-card-icon">
                        <i class="fas fa-church"></i>
                    </div>
                    <h3>Recursos Adventistas</h3>
                    <p>Materiales oficiales de la Iglesia Adventista</p>
                    <ul class="study-list">
                        <li><a href="https://www.adventistas.org/es/creencias/" target="_blank"><i
                                    class="fas fa-list-check"></i> 28 Creencias Fundamentales</a></li>
                        <li><a href="https://www.ministeriosnpe.org/" target="_blank"><i
                                    class="fas fa-graduation-cap"></i> Ministerios Nuevos Personas</a></li>
                        <li><a href="https://www.hopetv.org/es/" target="_blank"><i class="fas fa-tv"></i> HopeTV en
                                Espa√±ol</a></li>
                        <li><a href="https://www.adventistas.org/es/radio/" target="_blank"><i
                                    class="fas fa-podcast"></i> Radio Adventista</a></li>
                    </ul>
                </div>

                <!-- Plan de Lectura -->
                <div class="study-card">
                    <div class="study-card-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <h3>Plan de Lectura B√≠blica</h3>
                    <p>Lee la Biblia completa en un a√±o</p>
                    <ul class="study-list">
                        <li><i class="fas fa-calendar-day"></i> Plan de 365 d√≠as</li>
                        <li><i class="fas fa-bookmark"></i> Antiguo y Nuevo Testamento</li>
                        <li><i class="fas fa-clock"></i> 15-20 minutos diarios</li>
                        <li><i class="fas fa-chart-line"></i> Seguimiento de progreso</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Biblioteca de Esperanza Section -->
    <section id="biblioteca" class="section library-section">
        <div class="container">
            <div class="section-header">
                <i class="fas fa-book section-icon"></i>
                <h2 class="section-title">Biblioteca de Esperanza</h2>
                <p class="section-description">Obras de Elena G. de White y recursos inspiradores</p>
            </div>

            <div class="library-intro">
                <p>Elena G. de White fue una de las fundadoras de la Iglesia Adventista del S√©ptimo D√≠a. Sus escritos
                    han inspirado a millones de personas en todo el mundo. Aqu√≠ encontrar√°s acceso a sus obras m√°s
                    importantes.</p>
            </div>

            <div class="books-grid">
                <!-- El Camino a Cristo -->
                <div class="book-card">
                    <div class="book-cover">
                        <i class="fas fa-cross"></i>
                    </div>
                    <h3>El Camino a Cristo</h3>
                    <p>Una gu√≠a para encontrar paz y esperanza en Jes√∫s</p>
                    <a href="https://egwwritings.org/read?panels=p8.1&index=0" target="_blank" class="btn btn-outline">
                        <i class="fas fa-external-link-alt"></i> Leer en L√≠nea
                    </a>
                </div>

                <!-- El Conflicto de los Siglos -->
                <div class="book-card">
                    <div class="book-cover">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <h3>El Conflicto de los Siglos</h3>
                    <p>La gran controversia entre Cristo y Satan√°s</p>
                    <a href="https://egwwritings.org/read?panels=p132.1&index=0" target="_blank"
                        class="btn btn-outline">
                        <i class="fas fa-external-link-alt"></i> Leer en L√≠nea
                    </a>
                </div>

                <!-- El Deseado de Todas las Gentes -->
                <div class="book-card">
                    <div class="book-cover">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h3>El Deseado de Todas las Gentes</h3>
                    <p>La vida de Cristo narrada con profundidad</p>
                    <a href="https://egwwritings.org/read?panels=p130.1&index=0" target="_blank"
                        class="btn btn-outline">
                        <i class="fas fa-external-link-alt"></i> Leer en L√≠nea
                    </a>
                </div>

                <!-- Patriarcas y Profetas -->
                <div class="book-card">
                    <div class="book-cover">
                        <i class="fas fa-scroll"></i>
                    </div>
                    <h3>Patriarcas y Profetas</h3>
                    <p>Historia b√≠blica desde la creaci√≥n hasta el rey David</p>
                    <a href="https://egwwritings.org/read?panels=p84.1&index=0" target="_blank" class="btn btn-outline">
                        <i class="fas fa-external-link-alt"></i> Leer en L√≠nea
                    </a>
                </div>

                <!-- Palabras de Vida del Gran Maestro -->
                <div class="book-card">
                    <div class="book-cover">
                        <i class="fas fa-star"></i>
                    </div>
                    <h3>Palabras de Vida del Gran Maestro</h3>
                    <p>Las par√°bolas de Jes√∫s explicadas</p>
                    <a href="https://egwwritings.org/read?panels=p15.1&index=0" target="_blank" class="btn btn-outline">
                        <i class="fas fa-external-link-alt"></i> Leer en L√≠nea
                    </a>
                </div>

                <!-- Hechos de los Ap√≥stoles -->
                <div class="book-card">
                    <div class="book-cover">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>Hechos de los Ap√≥stoles</h3>
                    <p>Historia de la iglesia primitiva</p>
                    <a href="https://egwwritings.org/read?panels=p108.1&index=0" target="_blank"
                        class="btn btn-outline">
                        <i class="fas fa-external-link-alt"></i> Leer en L√≠nea
                    </a>
                </div>

                <!-- El Ministerio de Curaci√≥n -->
                <div class="book-card">
                    <div class="book-cover">
                        <i class="fas fa-hand-holding-medical"></i>
                    </div>
                    <h3>El Ministerio de Curaci√≥n</h3>
                    <p>Salud f√≠sica, mental y espiritual</p>
                    <a href="https://egwwritings.org/read?panels=p127.1&index=0" target="_blank"
                        class="btn btn-outline">
                        <i class="fas fa-external-link-alt"></i> Leer en L√≠nea
                    </a>
                </div>

                <!-- La Educaci√≥n -->
                <div class="book-card">
                    <div class="book-cover">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <h3>La Educaci√≥n</h3>
                    <p>Principios de la verdadera educaci√≥n</p>
                    <a href="https://egwwritings.org/read?panels=p29.1&index=0" target="_blank" class="btn btn-outline">
                        <i class="fas fa-external-link-alt"></i> Leer en L√≠nea
                    </a>
                </div>
            </div>

            <div class="library-footer">
                <p><i class="fas fa-info-circle"></i> Todos los libros est√°n disponibles gratuitamente en el sitio
                    oficial:</p>
                <a href="https://egwwritings.org/" target="_blank" class="btn btn-primary">
                    <i class="fas fa-globe"></i> Visitar EGW Writings
                </a>
            </div>
        </div>
    </section>

    <!-- Oraci√≥n Intercesora Section -->
    <section id="intercesora" class="section intercessory-section">
        <div class="container">
            <div class="section-header">
                <i class="fas fa-hands section-icon"></i>
                <h2 class="section-title">Muro de Oraci√≥n Intercesora</h2>
                <p class="section-description">√önete en oraci√≥n por las necesidades de nuestra comunidad</p>
            </div>

            <div class="intercessory-intro">
                <div class="intro-card">
                    <i class="fas fa-users"></i>
                    <h3>Oremos Juntos</h3>
                    <p>"La oraci√≥n ferviente del justo es muy poderosa y efectiva." - Santiago 5:16</p>
                </div>
            </div>

            <div id="intercessory-wall" class="intercessory-wall">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> Cargando peticiones...
                </div>
            </div>
        </div>
    </section>

    <!-- Noticias y Eventos Section -->
    <section id="noticias" class="section news-section">
        <div class="container">
            <div class="section-header">
                <i class="fas fa-newspaper section-icon"></i>
                <h2 class="section-title">Noticias y Eventos</h2>
                <p class="section-description">Mantente informado sobre las actividades de nuestra iglesia</p>
            </div>

            <div class="content-grid">
                <!-- Formulario de Noticia (solo para administradores) -->
                <div class="form-card">
                    <h3><i class="fas fa-plus-circle"></i> Publicar Noticia/Evento</h3>
                    <form id="news-form" class="news-form">
                        <div class="form-group">
                            <label for="news-title"><i class="fas fa-heading"></i> T√≠tulo</label>
                            <input type="text" id="news-title" name="titulo" required
                                placeholder="T√≠tulo de la noticia o evento">
                        </div>

                        <div class="form-group">
                            <label for="news-type"><i class="fas fa-list"></i> Tipo</label>
                            <select id="news-type" name="tipo" required>
                                <option value="">Selecciona el tipo</option>
                                <option value="noticia">Noticia</option>
                                <option value="evento">Evento</option>
                                <option value="anuncio">Anuncio</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="news-content"><i class="fas fa-pen"></i> Contenido</label>
                            <textarea id="news-content" name="contenido" required rows="5"
                                placeholder="Describe la noticia o evento..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="news-event-date"><i class="fas fa-calendar"></i> Fecha del Evento (si
                                aplica)</label>
                            <input type="datetime-local" id="news-event-date" name="fecha_evento">
                        </div>

                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Publicar
                        </button>
                    </form>
                </div>

                <!-- Lista de Noticias -->
                <div class="news-list-card">
                    <h3><i class="fas fa-list"></i> √öltimas Publicaciones</h3>
                    <div class="news-filter">
                        <button class="filter-btn active" data-type="todos">Todos</button>
                        <button class="filter-btn" data-type="noticia">Noticias</button>
                        <button class="filter-btn" data-type="evento">Eventos</button>
                        <button class="filter-btn" data-type="anuncio">Anuncios</button>
                    </div>
                    <div id="news-list" class="news-list">
                        <div class="loading">
                            <i class="fas fa-spinner fa-spin"></i> Cargando publicaciones...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contacto Section -->
    <section id="contacto" class="section contact-section">
        <div class="container">
            <div class="section-header">
                <i class="fas fa-envelope section-icon"></i>
                <h2 class="section-title">Cont√°ctanos</h2>
                <p class="section-description">Estamos aqu√≠ para servirte y acompa√±arte en tu caminar de fe</p>
            </div>

            <div class="contact-grid">
                <!-- Informaci√≥n de Contacto -->
                <div class="contact-info">
                    <h3>Informaci√≥n de la Iglesia</h3>

                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <div>
                            <h4>Direcci√≥n</h4>
                            <p>San Francisco de Limache<br>Regi√≥n de Valpara√≠so, Chile</p>
                        </div>
                    </div>

                    <div class="contact-item">
                        <i class="fas fa-clock"></i>
                        <div>
                            <h4>Horarios de Culto</h4>
                            <p><strong>S√°bados:</strong></p>
                            <p>Escuela Sab√°tica: 9:30 AM</p>
                            <p>Culto Divino: 11:00 AM</p>
                        </div>
                    </div>

                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <div>
                            <h4>Tel√©fono</h4>
                            <p>Pr√≥ximamente</p>
                        </div>
                    </div>

                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <div>
                            <h4>Email</h4>
                            <p>iasdsanfranciscodelimache@gmail.com</p>
                        </div>
                    </div>

                    <div class="social-media">
                        <h4>S√≠guenos</h4>
                        <div class="social-links">
                            <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
                            <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                            <a href="#" class="social-link"><i class="fab fa-youtube"></i></a>
                        </div>
                    </div>
                </div>

                <!-- Formulario de Contacto -->
                <div class="contact-form-card">
                    <h3>Env√≠anos un Mensaje</h3>
                    <form id="contact-form" class="contact-form">
                        <div class="form-group">
                            <label for="contact-name"><i class="fas fa-user"></i> Nombre Completo</label>
                            <input type="text" id="contact-name" required placeholder="Tu nombre">
                        </div>

                        <div class="form-group">
                            <label for="contact-email"><i class="fas fa-envelope"></i> Email</label>
                            <input type="email" id="contact-email" required placeholder="tu@email.com">
                        </div>

                        <div class="form-group">
                            <label for="contact-phone"><i class="fas fa-phone"></i> Tel√©fono (opcional)</label>
                            <input type="tel" id="contact-phone" placeholder="+56 9 1234 5678">
                        </div>

                        <div class="form-group">
                            <label for="contact-message"><i class="fas fa-comment"></i> Mensaje</label>
                            <textarea id="contact-message" required rows="5"
                                placeholder="¬øEn qu√© podemos ayudarte?"></textarea>
                        </div>

                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Enviar Mensaje
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="main-footer">
    <div class="container">
        <div class="footer-content">
            <div class="footer-section">
                <h4 class="footer-ref">Salmos 23:1</h4>
                <h3 class="footer-verse">
                    "El Se√±or es mi pastor, nada me faltar√°"
                </h3>
                </div>

                <div class="footer-section">
                    <h4>Enlaces √ötiles</h4>
                    <ul>
                        <li><a href="https://www.adventistas.org/es/" target="_blank">Iglesia Adventista Mundial</a>
                        </li>
                        <li><a href="https://www.adventistas.cl/" target="_blank">Adventistas Chile</a></li>
                        <li><a href="https://escuelasabatica.cl/" target="_blank">Escuela Sab√°tica</a></li>
                        <li><a href="https://egwwritings.org/" target="_blank">EGW Writings</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h4>Comunidad</h4>
                    <ul>
                        <li><a href="#oraciones">Pedidos de Oraci√≥n</a></li>
                        <li><a href="#testimonios">Testimonios</a></li>
                        <li><a href="#estudio">Estudio B√≠blico</a></li>
                        <li><a href="#contacto">Contacto</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2025 Iglesia Adventista del S√©ptimo D√≠a - San Francisco de Limache</p>
                <p style="font-weight: bold; color: #fff;">Desarrollado con amor MGE</p>
            </div>
        </div>
    </footer>
    <!-- Scripts -->
    <script src="js/main.js"></script>

    <script>
        function volverAPK() {
            if (window.history.length > 1) {
                window.history.back();
            } else {
                window.close();
            }
        }
    </script>
    <div id="toast" class="toast success">
        <span id="toast-icon" class="toast-icon">üôè</span>
        <span id="toast-text"></span>
        <button onclick="closeToast()">‚úï</button>
    </div>

    <audio id="toast-sound">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-message-pop-alert-2354.mp3" type="audio/mpeg">
    </audio>

    <script>
        const menuToggle = document.getElementById('menuToggle');
        const navMenu = document.getElementById('navMenu');

        menuToggle.addEventListener('click', () => {
            navMenu.classList.toggle('active');
        });

        // Cerrar men√∫ al hacer clic en un enlace
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', () => {
                navMenu.classList.remove('active');
            });
        });
    </script>


    <script>
        // --- L√ìGICA DE ALMACENAMIENTO Y SEGURIDAD ---
        const storage = {
            // Guarda los datos en el navegador del usuario
            save: (key, obj) => {
                let data = JSON.parse(localStorage.getItem(key)) || [];
                data.unshift(obj); // Agrega al inicio para que lo m√°s nuevo salga arriba
                localStorage.setItem(key, JSON.stringify(data));
                renderAll();
            },
            // Borra un elemento pidiendo la clave 'iasdsf'
            delete: (key, index) => {
                const pass = prompt("Contrase√±a de Administrador para eliminar:");
                if (pass === "iasdsf") {
                    let data = JSON.parse(localStorage.getItem(key));
                    data.splice(index, 1);
                    localStorage.setItem(key, JSON.stringify(data));
                    renderAll();
                } else if (pass !== null) {
                    alert("Contrase√±a incorrecta. No tienes permisos.");
                }
            },
            get: (key) => JSON.parse(localStorage.getItem(key)) || []
        };

        // --- FUNCI√ìN PARA MOSTRAR LOS DATOS EN LAS LISTAS ---
        function renderList(key, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;

            const items = storage.get(key);
            container.innerHTML = items.length ? '' : '<p style="padding:20px; color:#666;">A√∫n no hay publicaciones en esta secci√≥n.</p>';

            items.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'post-item'; // Usa la clase que definimos en el CSS
                div.style = "background:#fff; padding:15px; border-radius:8px; border-left:4px solid #002D56; margin-bottom:15px; box-shadow:0 2px 5px rgba(0,0,0,0.1);";

                div.innerHTML = `
                <h4 style="color:#002D56; margin-bottom:5px; text-transform:capitalize;">${item.category || item.title || 'Publicaci√≥n'}</h4>
                <p style="margin-bottom:8px; font-size:0.95rem; color:#333;">${item.text}</p>
                <div style="font-size:0.8rem; color:#777; font-style:italic;">Por: ${item.name} - ${item.date}</div>
                <button onclick="storage.delete('${key}', ${index})" 
                        style="background:#ff4d4d; color:#fff; border:none; padding:4px 8px; border-radius:4px; font-size:0.7rem; cursor:pointer; margin-top:10px;">
                    <i class="fas fa-trash"></i> Eliminar
                </button>
            `;
                container.appendChild(div);
            });
        }

        function renderAll() {
            renderList('pedidos', 'prayers-list');
            renderList('agradecimientos', 'thanksgiving-list');
            renderList('testimonios', 'testimonies-list');
        }

        // --- EVENTOS DE LOS FORMULARIOS ---

        // Pedidos de Oraci√≥n
        const prayerForm = document.getElementById('prayer-form');
        if (prayerForm) {
            prayerForm.onsubmit = function (e) {
                e.preventDefault();
                storage.save('pedidos', {
                    name: document.getElementById('prayer-name').value,
                    category: document.getElementById('prayer-category').value,
                    text: document.getElementById('prayer-request').value,
                    date: new Date().toLocaleDateString()
                });
                this.reset();
                alert("Pedido enviado con √©xito.");
            };
        }

        // Agradecimientos
        const thanksForm = document.getElementById('thanksgiving-form');
        if (thanksForm) {
            thanksForm.onsubmit = function (e) {
                e.preventDefault();
                storage.save('agradecimientos', {
                    name: document.getElementById('thanks-name').value,
                    category: document.getElementById('thanks-category').value,
                    text: document.getElementById('thanks-testimony').value,
                    date: new Date().toLocaleDateString()
                });
                this.reset();
                alert("Agradecimiento compartido.");
            };
        }

        // Testimonios
        const testimonyForm = document.getElementById('testimony-form');
        if (testimonyForm) {
            testimonyForm.onsubmit = function (e) {
                e.preventDefault();
                storage.save('testimonios', {
                    name: document.getElementById('testimony-name').value,
                    title: document.getElementById('testimony-title').value,
                    text: document.getElementById('testimony-content').value,
                    date: new Date().toLocaleDateString()
                });
                this.reset();
                alert("Testimonio guardado.");
            };
        }

        // --- MEN√ö M√ìVIL (HAMBURGUESA) ---
        const menuToggle = document.getElementById('menuToggle');
        const navMenu = document.getElementById('navMenu');
        if (menuToggle && navMenu) {
            menuToggle.onclick = function () {
                navMenu.style.display = navMenu.style.display === 'flex' ? 'none' : 'flex';
            };
        }

        // Cargar todo al iniciar la p√°gina
        window.onload = renderAll;
    </script>



    <style>
        .post-item {
            background: #ffffff;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid var(--primary-blue);
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .btn-delete-admin {
            background: #ff4d4d;
            color: white !important;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .btn-delete-admin:hover {
            background: #cc0000;
        }
    </style>

    <script>
        const CLAVE_ADMIN = "iasdsf";

        // 1. Base de Datos Local
        const iasdDB = {
            save: (key, data) => {
                let list = JSON.parse(localStorage.getItem(key)) || [];
                list.unshift(data);
                localStorage.setItem(key, JSON.stringify(list));
                actualizarListas();
                Swal.fire({
                    title: '¬°Registrado!',
                    text: 'Tu informaci√≥n se guard√≥ correctamente.',
                    icon: 'success',
                    confirmButtonColor: '#002D56'
                });
            },
            get: (key) => JSON.parse(localStorage.getItem(key)) || []
        };

        // 2. Validaci√≥n de Contrase√±a
        async function validarAccion(callback) {
            const { value: password } = await Swal.fire({
                title: 'Validaci√≥n de Seguridad',
                input: 'password',
                inputLabel: 'Introduce la contrase√±a para continuar',
                inputPlaceholder: 'Contrase√±a',
                inputAttributes: {
                    autocapitalize: 'off',
                    autocorrect: 'off'
                },
                showCancelButton: true,
                confirmButtonColor: '#002D56'
            });

            if (password === CLAVE_ADMIN) {
                callback();
            } else if (password !== undefined) {
                Swal.fire({ icon: 'error', title: 'Error', text: 'Contrase√±a incorrecta.' });
            }
        }


        document.addEventListener('DOMContentLoaded', function () {
            const menuToggle = document.getElementById('menuToggle');
            const navMenu = document.getElementById('navMenu');

            if (menuToggle) {
                menuToggle.addEventListener('click', function () {
                    navMenu.classList.toggle('active');
                    // Opcional: Animaci√≥n del bot√≥n
                    this.classList.toggle('open');
                });
            }

            // Cerrar men√∫ al hacer click en un link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', () => {
                    navMenu.classList.remove('active');
                });
            });
        });
        // 3. Captura de Formularios
        document.addEventListener('submit', function (e) {
            e.preventDefault();
            const form = e.target;
            let data = {
                date: new Date().toLocaleString('es-CL'),
                name: "", category: "", content: ""
            };
            let storageKey = "";

            if (form.id === 'prayer-form') {
                data.name = document.getElementById('prayer-name').value;
                data.category = document.getElementById('prayer-category').value;
                data.content = document.getElementById('prayer-request').value;
                storageKey = 'pedidos';
            }
            else if (form.id === 'thanksgiving-form') {
                data.name = document.getElementById('thanks-name').value;
                data.category = document.getElementById('thanks-category').value;
                data.content = document.getElementById('thanks-testimony').value;
                storageKey = 'agradecimientos';
            }
            else if (form.id === 'testimony-form') {
                data.name = document.getElementById('testimony-name').value;
                data.category = document.getElementById('testimony-title').value;
                data.content = document.getElementById('testimony-content').value;
                storageKey = 'testimonios';
            }

            if (storageKey) {
                iasdDB.save(storageKey, data);
                form.reset();
            }
        });

        // 4. Dibujar Listas y Eliminar
        function dibujar(idContenedor, key) {
            const contenedor = document.getElementById(idContenedor);
            if (!contenedor) return;
            const datos = iasdDB.get(key);
            contenedor.innerHTML = datos.length ? "" : "<p style='color:gray; padding:20px;'>No hay registros.</p>";

            datos.forEach((item, index) => {
                const card = document.createElement('div');
                card.style = "background:white; padding:15px; margin-bottom:10px; border-radius:10px; border-left:5px solid #002D56; box-shadow:0 2px 5px rgba(0,0,0,0.1); position:relative;";
                card.innerHTML = `
                <div style="font-size:11px; font-weight:bold; color:#002D56;">${item.category.toUpperCase()}</div>
                <p style="margin:5px 0; font-size:14px;">${item.content}</p>
                <div style="font-size:10px; color:gray;">${item.name} - ${item.date}</div>
                <button onclick="intentarEliminar('${key}', ${index})" style="position:absolute; top:5px; right:10px; border:none; background:none; color:red; cursor:pointer; font-weight:bold;">&times;</button>
            `;
                contenedor.appendChild(card);
            });
        }

        function intentarEliminar(key, index) {
            validarAccion(() => {
                let list = iasdDB.get(key);
                list.splice(index, 1);
                localStorage.setItem(key, JSON.stringify(list));
                actualizarListas();
                Swal.fire('Eliminado', 'El registro ha sido borrado.', 'success');
            });
        }

        function actualizarListas() {
            dibujar('prayers-list', 'pedidos');
            dibujar('thanksgiving-list', 'agradecimientos');
            dibujar('testimonies-list', 'testimonios');
        }

        // 5. PDF y Panel Administrativo
        function generarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFillColor(0, 45, 86);
            doc.rect(0, 0, 210, 30, 'F');
            doc.setTextColor(255, 255, 255);
            doc.text("REPORTE IASD SAN FRANCISCO DE LIMACHE", 15, 18);

            let y = 40;
            [{ k: 'pedidos', t: 'PETICIONES' }, { k: 'agradecimientos', t: 'AGRADECIMIENTOS' }, { k: 'testimonios', t: 'TESTIMONIOS' }].forEach(sec => {
                const data = iasdDB.get(sec.k);
                if (data.length > 0) {
                    doc.setTextColor(0, 45, 86);
                    doc.text(sec.t, 15, y);
                    doc.autoTable({ startY: y + 5, head: [['Fecha', 'Nombre', 'Detalle']], body: data.map(d => [d.date, d.name, d.content]), theme: 'grid' });
                    y = doc.lastAutoTable.finalY + 10;
                }
            });
            doc.save("Reporte_Iglesia.pdf");
        }

        function crearPanelAdmin() {
            const panel = document.createElement('div');
            panel.style = "position:fixed; bottom:20px; right:20px; z-index:9999; display:flex; flex-direction:column; gap:10px;";
            panel.innerHTML = `
            <button onclick="generarPDF()" style="background:#28a745; color:white; border:none; padding:12px; border-radius:50%; width:50px; height:50px; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.3);"><i class="fas fa-file-pdf"></i></button>
            <button onclick="validarAccion(() => { localStorage.clear(); location.reload(); })" style="background:#dc3545; color:white; border:none; padding:12px; border-radius:50%; width:50px; height:50px; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.3);"><i class="fas fa-trash"></i></button>
        `;
            document.body.appendChild(panel);
        }

        window.onload = () => { actualizarListas(); crearPanelAdmin(); };
    </script>


    <script>
        // --- 1. CONFIGURACI√ìN DE INTERFAZ ---
        const iasdUI = {
            success: (msg) => {
                Swal.fire({
                    title: '¬°Registrado!',
                    text: msg,
                    icon: 'success',
                    confirmButtonColor: '#002D56'
                });
            },
            error: (msg) => Swal.fire({ title: 'Aviso', text: msg, icon: 'warning', confirmButtonColor: '#002D56' }),
            confirm: (title, callback) => {
                Swal.fire({
                    title: title,
                    text: "Esta acci√≥n requiere validaci√≥n.",
                    input: 'password',
                    inputPlaceholder: 'Clave: iasdsf',
                    showCancelButton: true,
                    confirmButtonColor: '#002D56'
                }).then((result) => {
                    if (result.value === "iasdsf") callback();
                    else if (result.value !== undefined) Swal.fire('Error', 'Clave incorrecta', 'error');
                });
            }
        };


        // 1. Configuraci√≥n de Seguridad
        const CLAVE_ADMIN = "iasdsf";

        // 2. Base de Datos Local con Correcci√≥n de Errores
        const iasdDB = {
            save: (key, data) => {
                try {
                    let list = JSON.parse(localStorage.getItem(key)) || [];
                    list.unshift(data);
                    localStorage.setItem(key, JSON.stringify(list));

                    // Refrescar visualmente
                    if (typeof actualizarListas === 'function') {
                        actualizarListas();
                    }

                    Swal.fire({
                        title: '¬°Guardado con √©xito!',
                        text: 'La informaci√≥n ya est√° disponible en el sistema.',
                        icon: 'success',
                        confirmButtonColor: '#002D56'
                    });
                } catch (e) {
                    console.error("Error al guardar:", e);
                    Swal.fire('Error', 'No se pudo guardar en la memoria del navegador', 'error');
                }
            },
            get: (key) => {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : [];
            }
        };

        // 3. Generador de PDF Robusto
        function generarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Encabezado Azul Rey
            doc.setFillColor(0, 45, 86);
            doc.rect(0, 0, 210, 30, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(16);
            doc.text("REPORTE IASD SAN FRANCISCO DE LIMACHE", 15, 20);

            let y = 45;
            const secciones = [
                { id: 'pedidos', titulo: 'PETICIONES' },
                { id: 'agradecimientos', titulo: 'AGRADECIMIENTOS' },
                { id: 'testimonios', titulo: 'TESTIMONIOS' }
            ];

            let hayDatos = false;

            secciones.forEach(sec => {
                const datos = iasdDB.get(sec.id);
                if (datos && datos.length > 0) {
                    hayDatos = true;
                    doc.setTextColor(0, 45, 86);
                    doc.setFontSize(14);
                    doc.text(sec.titulo, 15, y);

                    doc.autoTable({
                        startY: y + 5,
                        head: [['Fecha', 'Nombre', 'Detalle']],
                        body: datos.map(item => [
                            item.date || "S/F",
                            item.name || "An√≥nimo",
                            item.content || "Sin detalle"
                        ]),
                        headStyles: { fillColor: [0, 188, 140] },
                        theme: 'grid',
                        styles: { fontSize: 10 }
                    });
                    y = doc.lastAutoTable.finalY + 15;
                }
            });

            if (!hayDatos) {
                Swal.fire('Atenci√≥n', 'No hay datos guardados para generar el reporte.', 'info');
            } else {
                doc.save("Reporte_Iglesia_San_Francisco.pdf");
            }
        }

        // 4. Captura Correcta de Formularios (Evita el "Falso Error")
        document.addEventListener('submit', function (e) {
            e.preventDefault();
            const form = e.target;

            // Seleccionamos los campos de forma m√°s precisa
            const inputNombre = form.querySelector('input[type="text"]');
            const inputContenido = form.querySelector('textarea');
            const inputCategoria = form.querySelector('select');

            // Validamos que al menos el contenido exista
            if (!inputContenido || inputContenido.value.trim() === "") {
                return Swal.fire('Error', 'El campo de mensaje no puede estar vac√≠o', 'error');
            }

            const nuevoDato = {
                date: new Date().toLocaleString('es-CL'),
                name: inputNombre ? inputNombre.value : "An√≥nimo",
                category: inputCategoria ? inputCategoria.value : "General",
                content: inputContenido.value
            };

            // Identificamos el destino por el ID del formulario
            let storageKey = "";
            if (form.id.includes('prayer')) storageKey = 'pedidos';
            else if (form.id.includes('thanks')) storageKey = 'agradecimientos';
            else if (form.id.includes('testimony')) storageKey = 'testimonios';

            if (storageKey !== "") {
                iasdDB.save(storageKey, nuevoDato);
                form.reset();
            } else {
                Swal.fire('Error', 'No se reconoci√≥ el tipo de formulario', 'error');
            }
        });

        // 5. Validaci√≥n de Contrase√±a para Eliminar
        async function validarAccion(callback) {
            const { value: password } = await Swal.fire({
                title: 'Acceso Restringido',
                input: 'password',
                inputLabel: 'Contrase√±a para limpiar o eliminar:',
                inputPlaceholder: 'Ingresa clave admin',
                confirmButtonColor: '#002D56',
                showCancelButton: true
            });

            if (password === CLAVE_ADMIN) {
                callback();
            } else if (password !== undefined) {
                Swal.fire('Error', 'Contrase√±a incorrecta', 'error');
            }
        }

    </script>


    <script>
        // 1. Funci√≥n para dibujar las tarjetas en pantalla
        function dibujar(idContenedor, key) {
            const contenedor = document.getElementById(idContenedor);
            if (!contenedor) return;

            const datos = iasdDB.get(key);
            contenedor.innerHTML = datos.length ? "" : "<p style='color:gray; padding:20px;'>No hay registros a√∫n.</p>";

            datos.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = "card-registro"; // Puedes darle estilos en tu CSS
                card.style = "background:white; padding:15px; margin-bottom:12px; border-radius:10px; border-left:5px solid #002D56; box-shadow:0 2px 5px rgba(0,0,0,0.1); position:relative; animation: fadeIn 0.5s;";

                card.innerHTML = `
            <div style="font-size:11px; font-weight:bold; color:#002D56; margin-bottom:5px;">${item.category.toUpperCase()}</div>
            <p style="margin:0; font-size:14px; color:#333;">${item.content}</p>
            <div style="font-size:10px; color:gray; margin-top:8px;">
                <i class="fas fa-user"></i> ${item.name} | <i class="fas fa-calendar"></i> ${item.date}
            </div>
            <button onclick="intentarEliminar('${key}', ${index})"
                style="position:absolute; top:8px; right:10px; border:none; background:none; color:#dc3545; cursor:pointer; font-size:18px;">
                <i class="fas fa-times-circle"></i>
            </button>
            `;
                contenedor.appendChild(card);
            });
        }

        // 2. L√≥gica de eliminaci√≥n individual con contrase√±a
        function intentarEliminar(key, index) {
            validarAccion(() => {
                let list = iasdDB.get(key);
                list.splice(index, 1);
                localStorage.setItem(key, JSON.stringify(list));
                actualizarListas();
                Swal.fire('Eliminado', 'El registro ha sido borrado correctamente.', 'success');
            });
        }

        // 3. Funci√≥n para refrescar todas las vistas
        function actualizarListas() {
            dibujar('prayers-list', 'pedidos');
            dibujar('thanksgiving-list', 'agradecimientos');
            dibujar('testimonies-list', 'testimonios');
        }

        // 4. Crear el Panel Administrativo Flotante
        function crearPanelAdmin() {
            const panel = document.createElement('div');
            panel.style = "position:fixed; bottom:20px; right:20px; z-index:9999; display:flex; flex-direction:column; gap:10px;";
            panel.innerHTML = `
            <button onclick="generarPDF()" title="Descargar Reporte PDF"
                style="background:#28a745; color:white; border:none; padding:12px; border-radius:50%; width:55px; height:55px; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.3); transition:0.3s;">
                <i class="fas fa-file-pdf fa-lg"></i>
            </button>
            <button onclick="validarAccion(() => { localStorage.clear(); location.reload(); })" title="Limpiar todo el sistema"
                style="background:#dc3545; color:white; border:none; padding:12px; border-radius:50%; width:55px; height:55px; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.3); transition:0.3s;">
                <i class="fas fa-trash-alt fa-lg"></i>
            </button>
        `;
            document.body.appendChild(panel);
        }

        // Iniciar al cargar la p√°gina
        window.onload = () => {
            actualizarListas();
            crearPanelAdmin();
        };
    </script>
</body>



</html>